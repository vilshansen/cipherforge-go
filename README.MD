# **CipherForge CLI \- Sikker Filkryptering (Go)**

Dette er en kommando-linje applikation skrevet i Go (Golang) designet til sikker kryptering og dekryptering af filer ved hj칝lp af moderne, streamende kryptografiske primitiver.

V칝rkt칮jet f칮lger den kryptografiske konstruktion **Encrypt-then-MAC (EtM)** for at sikre b친de fortrolighed og autenticitet.

## **游 Kommandobrug**

### **Kryptering**

Krypterer en fil og gemmer den som et nyt output. Hvis intet \-p flag angives, genereres et st칝rkt, tilf칝ldigt password, som skal gemmes sikkert af brugeren.

\# Standard kryptering (genererer tilf칝ldigt password)  
go run cipherforge.go \-e \<input\_fil\> \<output\_fil\>

\# Kryptering med specifikt password  
go run cipherforge.go \-e \<input\_fil\> \<output\_fil\> \-p \<dit\_password\>

### **Dekryptering**

Dekrypterer en krypteret fil. Kr칝ver passwordindtastning via terminalen (skjult input).

go run cipherforge.go \-d \<input\_fil\> \<output\_fil\>

## **游댏 Kryptografiske Detaljer**

### **1\. N칮glederivation (KDF)**

* **Algoritme:** **Scrypt**  
* **Form친l:** At udlede kryptografisk st칝rke n칮gler fra et (potentielt svagt) bruger-password. Scrypt er designet til at v칝re hukommelseskr칝vende for at modvirke brute-force-angreb.  
* **Parametre (Konstanter i cipherforge.go):**  
  * ScryptN (Iterationer): **2^15** (32768)  
  * ScryptR (Block size): **8**  
  * ScryptP (Parallelization): **1**  
* **Outputn칮gle (TotalKeySize):** 64 bytes.

### **2\. N칮gleopdeling (Encrypt-then-MAC)**

De 64 bytes, der udledes af Scrypt, opdeles i to separate n칮gler for at opretholde princippet om "key separation":

| N칮gle | St칮rrelse | Brugt til |
| :---- | :---- | :---- |
| **EncKey** (Krypteringsn칮gle) | 32 bytes (256 bit) | AES-256 CTR |
| **MacKey** (Autentificeringsn칮gle) | 32 bytes (256 bit) | HMAC-SHA256 |

### **3\. Kryptering**

* **Algoritme:** **AES-256** i **Counter Mode (CTR)**.  
* **Fordele ved CTR:** Tillader streamende I/O og parallellisering, hvilket er essentielt for h친ndtering af store filer. Ciphertext-st칮rrelsen er identisk med Plaintext-st칮rrelsen.  
* **Initialization Vector (IV):** En tilf칝ldig **16-byte Nonce** genereres for hver kryptering og gemmes i headeren.

### **4\. Autentificering (MAC)**

* **Algoritme:** **HMAC-SHA256**.  
* **Form친l:** At sikre integriteten og autenticiteten af dataen og headeren.  
* **MAC-beregning:** HMAC-tagget beregnes over **hele Headeren** og **hele Ciphertexten** (de krypterede data).  
* **MAC-st칮rrelse (TagSize):** 32 bytes (256 bit).

## **游 Filstruktur (The CipherForge Format)**

Den krypterede outputfil er struktureret til at muligg칮re streamende operationer og MAC-verifikation.

| Sektion | St칮rrelse | Beskrivelse |
| :---- | :---- | :---- |
| **Header** (Associeret Data) | Variabel | Metadata n칮dvendig for dekryptering og n칮gleudledning. |
| **Ciphertext** | filesize \- Header \- Tag | De krypterede bytes fra den originale fil (ciphertext). |
| **HMAC Tag** | 32 bytes | Det beregnede HMAC-SHA256 tag. |

### **Header Detaljer**

Headeren er opbygget sekventielt:

1. **Magic Marker:** CIPHERFORGE-V00002 (Bruges til validering af filformatet).  
2. **Scrypt Parametre:** N, R, P (4 bytes hver, Big Endian).  
3. **Salt:** 16 bytes (Preceded by length).  
4. **Nonce (IV):** 16 bytes (Preceded by length).  
5. **Original Filnavn:** Base navnet p친 den originale inputfil (Preceded by length).

## **游띔 Sikkerhed og Integritet**

### **Encrypt-then-MAC (EtM)**

CipherForge anvender EtM-princippet, den anbefalede standard for authenticated encryption.

1. **Kryptering:** Plaintext krypteres til Ciphertext.  
2. **MAC:** HMAC beregnes over (Header \+ Ciphertext).  
3. **Output:** Filen gemmes som (Header \+ Ciphertext \+ HMAC Tag).

### **Dekryptering og Verifikation**

1. Header og HMAC Tag l칝ses.  
2. Scrypt-n칮gler udledes fra Password og Salt.  
3. En ny HMAC beregnes over (Header \+ Ciphertext).  
4. **Kritisk Skridt:** Den beregnede HMAC sammenlignes med det forventede HMAC Tag (ved hj칝lp af hmac.Equal).  
5. **Korrekthed:** Kun hvis HMAC'erne matcher (autentificering lykkes), forts칝tter dekrypteringen af Ciphertext.

**Dette forhindrer dekryptering af manipulerede eller korrupte filer og sikrer, at kun den korrekte n칮gle kan 친bne filen.**